<% content_for :head do %>
  <%= t '.title' %>
<% end %>


<% if @quotation.errors.any? %>
  <div id="error_explanation" class="alert alert-danger alert-dismissible">
    <%= t 'general.form_error' %>
  </div>
<% end %>

<%= form_for @quotation do |f| %>
<div class="box box-primary">
<div class="box box-default">

  <%= render 'form' , f: f %>

</div>
</div>




<div class="box box-danger">
<div class="box box-default">
<div class="row col-md-12">
<div class="row col-md-12">
<h4><%= t '.quotation_people' %></h4>
<%=   content_tag :button, "Add", :class => 'btn btn-primary', :onclick =>"addPerson()", :type => :button %>
</div>
</div>
<div class="box-body">
<div class="row" id="quotation_people_div">
<%= hidden_field_tag "quotation[size_people]", @quotation.quotation_people.size %>
<%= f.fields_for :quotation_people do |cp| %>
   <%= render 'quotation_person_fields', f: cp %>
<% end %>
</div>
</div>

</div>
</div>


<div class="box-footer">
<%= button_save new_quotation_path,quotations_path,f %>
</div>
<% end %>





<% content_for :javascript do %>






function addPerson(){


       $.ajax({
            url: "<%=add_person_path%>",
            dataType: 'html',
            method : 'GET',
            data: {
              size_people: $('#quotation_size_people').val()
            },

            success: function( html ) {

                     console.log(html);
                      $("#quotation_size_people").val( parseInt($("#quotation_size_people").val())+  1 );
                      $("#quotation_people_div").append(  html );

            },
              error : function(xhr, status) {

                <!-- console.log(status);
                console.log("@@@@@@@");
                console.log(xhr.responseText);
                -->
                alert('Erro na conex√£o, tente novamente...');
              },
              complete : function(xhr, status) {
                <!-- divBlock.hide();
                $("#exec_ajax").val('N');
                $("#executandoAjax").remove();
                -->
              },
              beforeSend: function(){
                  <!-- $("#exec_ajax").val('S');
                  divBlock.show();
                  -->
              }
          });



}




<% end %>
